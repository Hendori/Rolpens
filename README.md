Rolpens
=======
Rolpens is an implementation of an algorithm that re-rolls loops that were unrolled during compilation.

Getting started
---------------
[Install `uv`](https://docs.astral.sh/uv/getting-started/installation/). Then run

    uv run python -m rolpens  FILE.c

to re-roll loops in a file. The `samples/` folder contains a few files with unrolled loops.

The Rolpens script takes either files or directores as its input. Directories are searched recursively for files to process.
To save the re-rolled output, set an output directory using the `--output-dir` parameter.

To print some statistics about how well it did, use the `--stats` flag.

Support scripts
---------------
This repository contains a number of support scripts.
To run any of these scripts, use `uv`. E.g.,

    uv run python scripts/loop-offsets.py  path/to/coreutils-9.7

### `loopy.py`
This script generates a bunch of C files containing a `for` loop that the compiler can choose to unroll.

### `loop-offsets.py`
This script searches original source code for `for` loops, and tallies whether or not the loops start at 0, at any other numeric value, or at something that is not a numeric constant.

### `find-iterator-expressions.py`
The `find-iterator-expressions.py` script searches a body of code for `for` loops, and classifies the way in which the iterator variable is used in the loop body.

### `get-real-code.py`
This script downloads the software projects used in this publication from the internet.

### `dump-syntax-tree.py`
This script is used to inspect parts of the Abstract Syntax Tree generated by the parser. It shows the tree structure as an S-expression of the node types.

### `compilatron.py`
The Compilatron compiles a C file using a variety of compilers, using a variety of settings.

### `decomp-headless.py`
The `decomp-headless.py` script is a wrapper around Ghidra that decompiles a given binary and places its C output at the given location.

### `decompilatron.py`
The Decompilatron runs a variety of decompiler software products on a compiled binary. It does so by talking to a local instance of the [Decompiler Explorer (DCE)](https://github.com/decompiler-explorer/decompiler-explorer).
